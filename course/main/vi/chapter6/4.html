<meta charset="utf-8" /><meta http-equiv="content-security-policy" content=""><meta name="hf:doc:metadata" content="{&quot;local&quot;:&quot;chun-ho-v-tin-tokenize&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;chun-ho&quot;,&quot;title&quot;:&quot;Chu·∫©n ho√°&quot;},{&quot;local&quot;:&quot;pretokenization&quot;,&quot;title&quot;:&quot;Pre-tokenization&quot;},{&quot;local&quot;:&quot;sentencepiece&quot;,&quot;title&quot;:&quot;SentencePiece&quot;},{&quot;local&quot;:&quot;tng-quan-thut-ton&quot;,&quot;title&quot;:&quot;T·ªïng quan thu·∫≠t to√°n&quot;}],&quot;title&quot;:&quot;Chu·∫©n ho√° v√† ti·ªÅn tokenize&quot;}" data-svelte="svelte-1phssyn">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/assets/pages/__layout.svelte-hf-doc-builder.css">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/start-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/vendor-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/paths-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/pages/__layout.svelte-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/pages/chapter6/4.mdx-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/Tip-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/Youtube-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/IconCopyLink-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/CodeBlock-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/DocNotebookDropdown-hf-doc-builder.js"> 





<h1 class="relative group"><a id="chun-ho-v-tin-tokenize" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#chun-ho-v-tin-tokenize"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Chu·∫©n ho√° v√† ti·ªÅn tokenize
	</span></h1>



<div class="flex space-x-1 absolute z-10 right-0 top-0">
	<a href="https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/chapter6/section4.ipynb" target="_blank"><img alt="Open In Colab" class="!m-0" src="https://colab.research.google.com/assets/colab-badge.svg"></a>
	<a href="https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/chapter6/section4.ipynb" target="_blank"><img alt="Open In Studio Lab" class="!m-0" src="https://studiolab.sagemaker.aws/studiolab.svg"></a></div>
<p>Tr∆∞·ªõc khi ƒëi s√¢u h∆°n v√†o ba thu·∫≠t to√°n tokenize t·ª´ ph·ª• ph·ªï bi·∫øn nh·∫•t ƒë∆∞·ª£c s·ª≠ d·ª•ng v·ªõi c√°c m√¥ h√¨nh Transformer (M√£ h√≥a theo c·∫∑p [BPE], WordPiece v√† Unigram), tr∆∞·ªõc ti√™n ch√∫ng ta s·∫Ω xem x√©t ti·ªÅn x·ª≠ l√Ω m√† m·ªói tr√¨nh tokenize √°p d·ª•ng cho vƒÉn b·∫£n. D∆∞·ªõi ƒë√¢y l√† t·ªïng quan c·∫•p cao v·ªÅ c√°c b∆∞·ªõc trong pipeline tokenize:</p>
<div class="flex justify-center"><img class="block dark:hidden" src="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter6/tokenization_pipeline.svg" alt="The tokenization pipeline.">
<img class="hidden dark:block" src="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter6/tokenization_pipeline-dark.svg" alt="The tokenization pipeline."></div>
<p>Tr∆∞·ªõc khi t√°ch m·ªôt ƒëo·∫°n vƒÉn b·∫£n th√†nh c√°c token ph·ª• (d·ª±a theo m√¥ h√¨nh)tokenizer s·∫Ω th·ª±c hi·ªán 2 b∆∞·ªõc: <em>normalization</em> (chu·∫©n ho√°) v√† <em>pre-tokenization</em> (ti·ªÅn tokenize).</p>
<h2 class="relative group"><a id="chun-ho" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#chun-ho"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Chu·∫©n ho√°
	</span></h2>

<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/4IIC2jI9CaU" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>B∆∞·ªõc chu·∫©n h√≥a bao g·ªìm m·ªôt s·ªë thao t√°c d·ªçn d·∫πp, ch·∫≥ng h·∫°n nh∆∞ lo·∫°i b·ªè kho·∫£ng tr·∫Øng kh√¥ng c·∫ßn thi·∫øt, vi·∫øt th∆∞·ªùng t·∫•t c·∫£ c√°c ch·ªØ, v√†/ho·∫∑c x√≥a d·∫•u. N·∫øu b·∫°n ƒë√£ quen v·ªõi <a href="http://www.unicode.org/reports/tr15/" rel="nofollow">chu·∫©n h√≥a Unicode</a> (ch·∫≥ng h·∫°n nh∆∞ NFC ho·∫∑c NFKC), th√¨ ƒë√¢y c≈©ng l√† ƒëi·ªÅu m√† tokenizer c√≥ th·ªÉ √°p d·ª•ng.</p>
<p><code>tokenizer</code> c·ªßa ü§ó Transformers c√≥ m·ªôt thu·ªôc t√≠nh g·ªçi l√† <code>backend_tokenizer</code> cung c·∫•p quy·ªÅn truy c·∫≠p v√†o tokenizer b√™n d∆∞·ªõi t·ª´ th∆∞ vi·ªán ü§ó Tokenizers:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoTokenizer

tokenizer = AutoTokenizer.from_pretrained(<span class="hljs-string">&quot;bert-base-uncased&quot;</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(tokenizer.backend_tokenizer))<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;tokenizers.Tokenizer&#x27;</span>&gt;<!-- HTML_TAG_END --></pre></div>
<p>Thu·ªôc t√≠nh <code>normalizer</code> c·ªßa ƒë·ªëi t∆∞·ª£ng <code>tokenizer</code> c√≥ ph∆∞∆°ng th·ª©c <code>normalize_str()</code> m√† ta c√≥ th·ªÉ d√πng ƒë·ªÉ th·∫•y c√°ch b∆∞·ªõc chu·∫©n ho√° ƒë∆∞·ª£c th·ª±c hi·ªán:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-built_in">print</span>(tokenizer.backend_tokenizer.normalizer.normalize_str(<span class="hljs-string">&quot;H√©ll√≤ h√¥w are √º?&quot;</span>))<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;hello how are u?&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>Trong v√≠ d·ª• n√†y, v√¨ ch√∫ng ta ch·ªçn checkpoint <code>bert-base-uncased</code>, b∆∞·ªõc chu·∫©n ho√° s·∫Ω th·ª±c hi·ªán vi·∫øt th∆∞·ªùng v√† lo·∫°i b·ªè c√°c d·∫•u.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>‚úèÔ∏è <strong>Try it out!</strong> T·∫£i tokenizer t·ª´ checkpoint <code>bert-base-cased</code> v√† truy·ªÅn v√†o c√πng m·ªôt v√≠ d·ª• v√†o.S·ª± kh√°c bi·ªát ch√≠nh m√† b·∫°n c√≥ th·ªÉ th·∫•y gi·ªØa c√°c phi√™n b·∫£n c√≥ d·∫•u v√† kh√¥ng d·∫•u c·ªßa tokenizer l√† g√¨?</p></div>
<h2 class="relative group"><a id="pretokenization" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#pretokenization"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Pre-tokenization
	</span></h2>

<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/grlLV8AIXug" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Nh∆∞ ch√∫ng ta s·∫Ω th·∫•y trong c√°c ph·∫ßn ti·∫øp theo, m·ªôt tokenizer kh√¥ng th·ªÉ ƒë∆∞·ª£c hu·∫•n luy·ªán tr√™n vƒÉn b·∫£n th√¥. Thay v√†o ƒë√≥, tr∆∞·ªõc ti√™n ch√∫ng ta c·∫ßn chia c√°c vƒÉn b·∫£n th√†nh c√°c th·ª±c th·ªÉ nh·ªè, nh∆∞ c√°c t·ª´. ƒê√≥ l√† khi b∆∞·ªõc pre-tokenization b·∫Øt ƒë·∫ßu. Nh∆∞ ch√∫ng ta ƒë√£ th·∫•y trong <a href="/course/chapter2">Ch∆∞∆°ng 2</a>, tr√¨nh tokenize d·ª±a tr√™n t·ª´ c√≥ th·ªÉ ch·ªâ c·∫ßn t√°ch m·ªôt vƒÉn b·∫£n th√¥ th√†nh c√°c t·ª´ d·ª±a tr√™n kho·∫£ng tr·∫Øng v√† d·∫•u c√¢u. Nh·ªØng t·ª´ ƒë√≥ s·∫Ω l√† ranh gi·ªõi c·ªßa c√°c token con m√† tokenizer c√≥ th·ªÉ h·ªçc ƒë∆∞·ª£c trong qu√° tr√¨nh hu·∫•n luy·ªán c·ªßa n√≥.</p>
<p>ƒê·ªÉ xem c√°ch m·ªôt tokenizer nhanh th·ª±c hi·ªán pre-tokenization, ch√∫ng ta c√≥ th·ªÉ s·ª≠ d·ª•ng ph∆∞∆°ng th·ª©c <code>pre_tokenize_str()</code> c·ªßa thu·ªôc t√≠nh <code>pre_tokenizer</code> c·ªßa ƒë·ªëi t∆∞·ª£ng <code>tokenizer</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenizer.backend_tokenizer.pre_tokenizer.pre_tokenize_str(<span class="hljs-string">&quot;Hello, how are  you?&quot;</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[(<span class="hljs-string">&#x27;Hello&#x27;</span>, (<span class="hljs-number">0</span>, <span class="hljs-number">5</span>)), (<span class="hljs-string">&#x27;,&#x27;</span>, (<span class="hljs-number">5</span>, <span class="hljs-number">6</span>)), (<span class="hljs-string">&#x27;how&#x27;</span>, (<span class="hljs-number">7</span>, <span class="hljs-number">10</span>)), (<span class="hljs-string">&#x27;are&#x27;</span>, (<span class="hljs-number">11</span>, <span class="hljs-number">14</span>)), (<span class="hljs-string">&#x27;you&#x27;</span>, (<span class="hljs-number">16</span>, <span class="hljs-number">19</span>)), (<span class="hljs-string">&#x27;?&#x27;</span>, (<span class="hljs-number">19</span>, <span class="hljs-number">20</span>))]<!-- HTML_TAG_END --></pre></div>
<p>L∆∞u √Ω c√°ch tokenizer ƒë√£ theo d√µi c√°c offset, ƒë√≥ l√† c√°ch n√≥ c√≥ th·ªÉ cung c·∫•p cho ch√∫ng ta √°nh x·∫° offset m√† ta ƒë√£ s·ª≠ d·ª•ng trong ph·∫ßn tr∆∞·ªõc. ·ªû ƒë√¢y tokenizer b·ªè qua hai kho·∫£ng tr·∫Øng v√† thay th·∫ø ch√∫ng b·∫±ng ch·ªâ m·ªôt, nh∆∞ng c√°c offset xen gi·ªØa <code>are</code> v√† <code>you</code> ƒë·ªÉ gi·∫£i th√≠ch ƒëi·ªÅu ƒë√≥.</p>
<p>V√¨ ch√∫ng ta ƒëang s·ª≠ d·ª•ng BERT tokenizer, pre-tokenization li√™n quan ƒë·∫øn vi·ªác ph√¢n t√°ch d·ª±a tr√™n kho·∫£ng tr·∫Øng v√† d·∫•u ch·∫•m c√¢u. C√°c tokenizer kh√°c c√≥ th·ªÉ c√≥ c√°c quy t·∫Øc kh√°c nhau cho b∆∞·ªõc n√†y. V√≠ d·ª•: n·∫øu s·ª≠ d·ª•ng GPT-2 tokenizer:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenizer = AutoTokenizer.from_pretrained(<span class="hljs-string">&quot;gpt2&quot;</span>)
tokenizer.backend_tokenizer.pre_tokenizer.pre_tokenize_str(<span class="hljs-string">&quot;Hello, how are  you?&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>n√≥ s·∫Ω t√°ch d·ª±a tr√™n d·∫•u c√°ch v√† d·∫•u c√¢u, nh∆∞ng s·∫Ω gi·ªØa d·∫•u c√°ch v√† thay th·∫ø ch√∫ng b·ªüi k√≠ hi·ªáu <code>ƒ†</code>, cho ph√©p n√≥ kh√¥i ph·ª•c kh√¥ng gian ban ƒë·∫ßu n·∫øu ch√∫ng t√¥i gi·∫£i m√£ c√°c token:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[(<span class="hljs-string">&#x27;Hello&#x27;</span>, (<span class="hljs-number">0</span>, <span class="hljs-number">5</span>)), (<span class="hljs-string">&#x27;,&#x27;</span>, (<span class="hljs-number">5</span>, <span class="hljs-number">6</span>)), (<span class="hljs-string">&#x27;ƒ†how&#x27;</span>, (<span class="hljs-number">6</span>, <span class="hljs-number">10</span>)), (<span class="hljs-string">&#x27;ƒ†are&#x27;</span>, (<span class="hljs-number">10</span>, <span class="hljs-number">14</span>)), (<span class="hljs-string">&#x27;ƒ†&#x27;</span>, (<span class="hljs-number">14</span>, <span class="hljs-number">15</span>)), (<span class="hljs-string">&#x27;ƒ†you&#x27;</span>, (<span class="hljs-number">15</span>, <span class="hljs-number">19</span>)),
 (<span class="hljs-string">&#x27;?&#x27;</span>, (<span class="hljs-number">19</span>, <span class="hljs-number">20</span>))]<!-- HTML_TAG_END --></pre></div>
<p>C·∫ßn l∆∞u √Ω th√™m r·∫±ng kh√¥ng nh∆∞ BERT tokenizer, tokenizer n√†y b·ªè qua d·∫•u c√°ch k√©p.</p>
<p>·ªû v√≠ d·ª• cu·ªëi, h√£y c√πng xem T5 tokenizer d·ª±a tr√™n thu·∫≠t to√°n SentencePiece:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenizer = AutoTokenizer.from_pretrained(<span class="hljs-string">&quot;t5-small&quot;</span>)
tokenizer.backend_tokenizer.pre_tokenizer.pre_tokenize_str(<span class="hljs-string">&quot;Hello, how are  you?&quot;</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[(<span class="hljs-string">&#x27;‚ñÅHello,&#x27;</span>, (<span class="hljs-number">0</span>, <span class="hljs-number">6</span>)), (<span class="hljs-string">&#x27;‚ñÅhow&#x27;</span>, (<span class="hljs-number">7</span>, <span class="hljs-number">10</span>)), (<span class="hljs-string">&#x27;‚ñÅare&#x27;</span>, (<span class="hljs-number">11</span>, <span class="hljs-number">14</span>)), (<span class="hljs-string">&#x27;‚ñÅyou?&#x27;</span>, (<span class="hljs-number">16</span>, <span class="hljs-number">20</span>))]<!-- HTML_TAG_END --></pre></div>
<p>Gi·ªëng nh∆∞ GPT-2 tokenizer, ph∆∞∆°ng ph√°p n√†y gi·ªØ c√°c d·∫•u c√°ch v√† thay th·∫ø ch√∫ng b·ªüi m·ªôt t√≠ t·ª± ƒë·∫∑c bi·ªát (<code>_</code>), nh∆∞ng T5 tokenizer ch·ªâ t√°ch d·ª±a theo d·∫•u c√°ch, kh√¥ng d·ª±a theo d·∫•u c√¢u. M·ªôt l∆∞u √Ω n·ªØa ƒë√≥ l√† n√≥ c≈©ng m·∫∑c ƒë·ªãnh th√™m d·∫•u c√°ch ·ªü ph√≠a ƒë·∫ßu c√¢u (tr∆∞·ªõc <code>Hello</code>) v√† b·ªè qua nh·ªØng d·∫•u c√°ch k·∫πp ·ªü gi·ªØa <code>are</code> v√† <code>you</code>.</p>
<p>B√¢y gi·ªù ch√∫ng ta ƒë√£ bi·∫øt m·ªôt ch√∫t v·ªÅ c√°ch m·ªôt s·ªë lo·∫°i tokenizers kh√°c nhau ƒë·ªÉ x·ª≠ l√Ω vƒÉn b·∫£n, ch√∫ng ta c√≥ th·ªÉ b·∫Øt ƒë·∫ßu t·ª± kh√°m ph√° c√°c thu·∫≠t to√°n c∆° b·∫£n. Ch√∫ng ta s·∫Ω b·∫Øt ƒë·∫ßu b·∫±ng m·ªôt c√°i nh√¨n nhanh v·ªÅ SentencePiece ƒë∆∞·ª£c √°p d·ª•ng r·ªông r√£i; sau ƒë√≥, trong ba ph·∫ßn ti·∫øp theo, ch√∫ng ta s·∫Ω xem x√©t c√°ch th·ª©c ho·∫°t ƒë·ªông c·ªßa ba thu·∫≠t to√°n ch√≠nh ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ m√£ h√≥a t·ª´ ph·ª•.</p>
<h2 class="relative group"><a id="sentencepiece" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#sentencepiece"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>SentencePiece
	</span></h2>

<p><a href="https://github.com/google/sentencepiece" rel="nofollow">SentencePiece</a> l√† m·ªôt thu·∫≠t to√°n tokenize ƒë·ªÉ ti·ªÅn x·ª≠ l√Ω vƒÉn b·∫£n m√† b·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng v·ªõi b·∫•t k·ª≥ m√¥ h√¨nh n√†o ch√∫ng ta s·∫Ω th·∫•y trong ba ph·∫ßn ti·∫øp theo. N√≥ coi vƒÉn b·∫£n l√† m·ªôt chu·ªói c√°c k√Ω t·ª± Unicode v√† thay th·∫ø d·∫•u c√°ch b·∫±ng m·ªôt k√Ω t·ª± ƒë·∫∑c bi·ªát, <code>‚ñÅ</code>. ƒê∆∞·ª£c s·ª≠ d·ª•ng c√πng v·ªõi thu·∫≠t to√°n Unigram (xem <a href="/course/chapter7/7">ph·∫ßn 7</a>), n√≥ th·∫≠m ch√≠ kh√¥ng y√™u c·∫ßu b∆∞·ªõc pre-tokenization, r·∫•t h·ªØu √≠ch cho c√°c ng√¥n ng·ªØ kh√¥ng s·ª≠ d·ª•ng d·∫•u c√°ch (nh∆∞ Trung Qu·ªëc ho·∫∑c Nh·∫≠t B·∫£n).</p>
<p>T√≠nh nƒÉng ch√≠nh kh√°c c·ªßa SentencePiece l√† <em>reversible tokenization</em> hay <em>tokenize c√≥ th·ªÉ ƒë·∫£o ng∆∞·ª£c</em>: v√¨ kh√¥ng c√≥ c√°ch x·ª≠ l√Ω ƒë·∫∑c bi·ªát n√†o cho d·∫•u c√°ch, n√™n vi·ªác gi·∫£i m√£ c√°c token ƒë∆∞·ª£c th·ª±c hi·ªán ƒë∆°n gi·∫£n b·∫±ng c√°ch n·ªëi ch√∫ng v√† thay th·∫ø c√°c d·∫•u <code>_</code> b·∫±ng d·∫•u c√°ch - ƒëi·ªÅu n√†y gi√∫p vƒÉn b·∫£n ƒë∆∞·ª£c chu·∫©n h√≥a. Nh∆∞ ch√∫ng ta ƒë√£ th·∫•y tr∆∞·ªõc ƒë√≥, BERT tokenizer lo·∫°i b·ªè c√°c d·∫•u c√°ch l·∫∑p l·∫°i, v√¨ v·∫≠y token c·ªßa n√≥ kh√¥ng th·ªÉ ƒë·∫£o ng∆∞·ª£c.</p>
<h2 class="relative group"><a id="tng-quan-thut-ton" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#tng-quan-thut-ton"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>T·ªïng quan thu·∫≠t to√°n
	</span></h2>

<p>Trong c√°c ph·∫ßn ti·∫øp theo, ch√∫ng ta s·∫Ω ƒëi s√¢u v√†o ba thu·∫≠t to√°n tokenize t·ª´ ph·ª• ti√™u bi·ªÉu: BPE (ƒë∆∞·ª£c s·ª≠ d·ª•ng b·ªüi GPT-2 v√† c√°c thu·∫≠t to√°n kh√°c), WordPiece (ƒë∆∞·ª£c s·ª≠ d·ª•ng b·ªüi BERT) v√† Unigram (ƒë∆∞·ª£c s·ª≠ d·ª•ng b·ªüi T5 v√† c√°c thu·∫≠t to√°n kh√°c). Tr∆∞·ªõc khi ch√∫ng ta b·∫Øt ƒë·∫ßu, ƒë√¢y l√† t·ªïng quan nhanh v·ªÅ c√°ch ho·∫°t ƒë·ªông c·ªßa t·ª´ng lo·∫°i. ƒê·ª´ng ng·∫ßn ng·∫°i quay l·∫°i b·∫£ng n√†y sau khi ƒë·ªçc t·ª´ng ph·∫ßn ti·∫øp theo n·∫øu b·∫°n ch∆∞a hi·ªÉu h·∫øt.</p>
<table><thead><tr><th align="center">M√¥ h√¨nh</th>
<th align="center">BPE</th>
<th align="center">WordPiece</th>
<th align="center">Unigram</th></tr></thead>
<tbody><tr><td align="center">Hu·∫•n luy·ªán</td>
<td align="center">B·∫Øt ƒë·∫ßu v·ªõi m·ªôt b·ªô t·ª´ v·ª±ng nh·ªè v√† h·ªçc b·ªô quy t·∫Øc h·ª£p nh·∫•t token</td>
<td align="center">B·∫Øt ƒë·∫ßu v·ªõi m·ªôt b·ªô t·ª´ v·ª±ng nh·ªè v√† h·ªçc b·ªô quy t·∫Øc h·ª£p nh·∫•t token</td>
<td align="center">B·∫Øt ƒë·∫ßu v·ªõi m·ªôt b·ªô t·ª´ v·ª±ng l·ªõn v√† h·ªçc b·ªô quy t·∫Øc ƒë·ªÉ lo·∫°i b·ªè token</td></tr>
<tr><td align="center">B∆∞·ªõc hu·∫•n luy·ªán</td>
<td align="center">G·ªôp c√°c token li√™n quan ƒë·∫øn c·∫∑p ph·ªï bi·∫øn nh·∫•t</td>
<td align="center">G·ªôp c√°c token li√™n quan ƒë·∫øn c·∫∑p c√≥ ƒëi·ªÉm cao nh·∫•t d·ª±a tr√™n t·∫ßn su·∫•t c·ªßa c·∫∑p, with the best score based on the frequency of the pair,  ∆∞u ti√™n c√°c c·∫∑p m√† m·ªói token c√° nh√¢n t·∫ßn su·∫•t th·∫•p h∆°n</td>
<td align="center">Lo·∫°i b·ªè t·∫•t c·∫£ c√°c token trong b·ªô t·ª´ ƒëi·ªÉn gi·∫£m thi·ªÉu t·ªëi ƒëa ƒë·ªô m·∫•t m√°t ƒë∆∞·ª£c t√≠nh tr√™n to√†n b·ªô kho ng·ªØ li·ªáu</td></tr>
<tr><td align="center">H·ªçc</td>
<td align="center">G·ªôp b·ªô quy t·∫Øc v√† b·ªô t·ª´ v·ª±ng</td>
<td align="center">Ch·ªâ b·ªô t·ª´ v·ª±ng</td>
<td align="center">M·ªôt b·ªô t·ª± v·ª±ng v·ªõi ƒëi·ªÉm cho m·ªói token</td></tr>
<tr><td align="center">M√£ ho√°</td>
<td align="center">Chia t·ª´ th√†nh c√°c k√≠ t·ª± v√† √°p d·ª•ng b∆∞·ªõc g·ªôp t·ª´ qu√° tr√¨nh hu·∫•n luy·ªán</td>
<td align="center">T√¨m ra chu·ªói t·ª´ ph·ª• d√†i nh·∫•t b·∫Øt ƒë·∫ßu t·ª´ ph·∫ßn b·∫Øt ƒë·∫ßu c√≥ trong b·ªô t·ª´ v·ª±ng, sau ƒë√≥ l√†m t∆∞∆°ng t·ª± v·ªõi c√°c ph·∫ßn c√≤n l·∫°i c·ªßa t·ª´</td>
<td align="center">T√¨m t·ª´ c√≥ kh·∫£ nƒÉng chia th√†nh token cao nh·∫•t s·ª≠ d·ª•ng ƒëi·ªÉm c√≥ ƒë∆∞·ª£c t·ª´ qu√° tr√¨nh hu·∫•n luy·ªán</td></tr></tbody></table>
<p>Gi·ªù ch√∫ng ta h√£y ƒëi s√¢u v√†o BPE th√¥i!</p>


		<script type="module" data-hydrate="mzj2a9">
		import { start } from "/docs/course/main/vi/_app/start-hf-doc-builder.js";
		start({
			target: document.querySelector('[data-hydrate="mzj2a9"]').parentNode,
			paths: {"base":"/docs/course/main/vi","assets":"/docs/course/main/vi"},
			session: {},
			route: false,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/docs/course/main/vi/_app/pages/__layout.svelte-hf-doc-builder.js"),
						import("/docs/course/main/vi/_app/pages/chapter6/4.mdx-hf-doc-builder.js")
				],
				params: {}
			}
		});
	</script>
